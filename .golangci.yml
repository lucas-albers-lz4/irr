# .golangci.yml
#version:
#   value : 2
version : 2
run:
  go: "1.24"
  timeout: 5m
  issues-exit-code: 1
  tests: true
#  build-tags:
#    - integration

linters:
  enable:
    # Defaults (optional to list)
    - errcheck
    - govet
    - ineffassign
    - staticcheck
    - unused

    # Tier 1 additions
    - gosec
    - errorlint
    - wrapcheck
    - bodyclose
    - noctx
    - nilerr      # Consider enabling nilerr, nilnil, nilnesserr together
    - nilnil
    - nilnesserr
    - copyloopvar

    # Tier 2 additions (add incrementally)
    - revive
    - gocritic
    - misspell
    - goconst
    - predeclared
    - lll
    - mnd
    - dupl

  disable:
    - gomoddirectives
    - godot
  settings:
    depguard:
      rules:
        Main:
          allow:
            - $standard
            - "github.com/lalbers/irr/pkg"
            - "github.com/spf13/cobra"
            - "github.com/spf13/pflag"
            - "os"
            - "fmt"
            - "log"
            - "strings"
        Pkg:
          allow:
            - $standard
            - "github.com/lalbers/irr/pkg"
            - "helm.sh/helm/v3"
            - "sigs.k8s.io/yaml"
            - "gopkg.in/yaml.v3"
            - "github.com/pkg/errors"
        Test:
          allow:
            - $standard
            - "github.com/lalbers/irr/pkg"
            - "github.com/stretchr/testify"
            - "helm.sh/helm/v3"
            - "sigs.k8s.io/yaml"
            - "gopkg.in/yaml.v3"
    errcheck:
      check-type-assertions: true
      check-blank: true
    gocritic:
      enabled-tags:
        - diagnostic
        - experimental
        - opinionated
        - performance
        - style
      # Example: Disable specific checks after reviewing their output
      # disabled-checks:
      #   - hugeParam
      #   - rangeValCopy
      #   - exitAfterDefer
    lll:
      line-length: 140
    nolintlint:
      allow-unused: false
      require-explanation: true
      require-specific: true
    mnd:
      # Comma-separated list of checks to enable
      # Recommended: argument, assign, case, condition, return, operation
      checks: argument,assign,case,condition,return,operation
      # Comma-separated list of numbers to ignore
      ignored-numbers: 0,1,-1,80,443 # Add other common non-magic numbers relevant to your project
      # You can also ignore specific types or functions if needed
      # ignored-functions: ...
      # ignored-types: ...
    goconst:
      # Minimum length of string literals to consider
      min-len: 3 # Default is 3, adjust if needed
      # Minimum occurrences of a string literal to report
      min-occurrences: 3 # Default is 3, adjust if needed
      # ignore-tests: true # Optionally ignore strings in test files
    dupl:
      # Threshold for code duplication token sequence length
      threshold: 100 # Default is 100, adjust based on findings (lower finds more duplicates)
    revive:
      # Example: Adjust confidence level (0.0 to 1.0)
      # confidence: 0.8
      # Example: Ignore generated files (often default, but good practice)
      # ignore-generated-header: true
      # Example: Configure specific rules if needed
      # rule:
      #   exported:
      #     severity: warning # Default is error
    wrapcheck:
      # Comma-separated list of regexps for function/method signatures to ignore.
      # Example: ignore signatures returning standard library errors directly
      ignoreSigs:
        - \.Errorf\( # Don't require wrapping fmt.Errorf itself
        - os\.ReadFile\( # Example standard lib function
        - io\.Copy\( # Example standard lib function
      # You might add patterns for specific internal functions/methods too
    misspell:
      locale: US # Default is US. Use 'UK' for British English.
      # ignore-words: # Add list of custom words to ignore if needed
      #   - mycustomword

issues:
  max-issues-per-linter: 0
  max-same-issues: 0
  exclude:
    # Regex for paths to exclude from analysis
    - "zz_generated.*\\.go" # Exclude auto-generated files

output:
  # Removing keys that seem invalid in config file format
  # format: colored-line-number
  # print-issued-lines: true
  # print-linter-name: true
  # sort-results: true
  # Keep output section minimal or empty if defaults are okay
  # If specific format needed, verify exact key name from documentation / schema
